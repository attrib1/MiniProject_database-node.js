var express = require('express')
  , http = require('http')
  , mysql = require('mysql'); // <---- HERE

var app = express();



app.get('/',function(request,response){
	var connection = mysql.createConnection({
    host: 'localhost',
    user: 'root',
    password: "",
    database: 'lab_nodejs01'
});

connection.connect(); // <---- AND HERE

// all environments
app.set('port', process.env.PORT || 7002);

connection.query('SELECT * FROM restaurants', function(err, rows, fields)

    {
            console.log('Connection result error '+err);
            console.log('no of records is '+rows.length);
                    response.writeHead(200, { 'Content-Type': 'application/json'});
            response.end(JSON.stringify(rows));
    });

} );

http.createServer(app).listen(app.get('port'), function(){
  console.log('Express server listening on port ' + app.get('port'));
});